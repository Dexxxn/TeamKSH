<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- MedicalMapper.java와 연결 -->  
<mapper namespace="com.ksh.mapper.MedicalMapper">

	<select id="medical" resultType="com.ksh.model.MedicalVO">
		SELECT s_dept, s_name
		FROM Medical_Scheduling.staff
        WHERE s_id like 'D%'
	</select>
	
	<select id="medical2" resultType="com.ksh.model.MedicalVO">
		SELECT s_dept, s_name
		FROM Medical_Scheduling.staff
        WHERE s_id like 'D%'
 		<if test="s_dept != null">
			<choose>
				<when test="s_dept=='A'.toString()">
					and s_dept='정형외과'
				</when>
				<when test="s_dept=='B'.toString()">
					and s_dept='신경외과'
				</when>
				<otherwise>
					and s_dept='내과'
				</otherwise>
			</choose>
		</if>
	</select>
	
	<insert id="addSchedule">
		INSERT into Medical_Scheduling.schedule(s_no, s_date, s_type, s_startTime, s_endTime, s_memo, s_doctor)
		VALUES(#{s_no}, #{s_date}, #{s_type}, #{s_startTime}, #{s_endTime}, #{s_memo}, #{s_doctor});
	</insert>
	
	<resultMap type="ScheduleVO" id="ScheduleVO">
	    <result column="BBB_UID" property="bbbUid"/>
	    <result column="BBB_COL1" property="bbbCol1"/>
	    <result column="BBB_UID" property="bbbUid"/>
	    <result column="BBB_COL1" property="bbbCol1"/>
	    <result column="BBB_UID" property="bbbUid"/>
	    <result column="BBB_COL1" property="bbbCol1"/>	    	    
	</resultMap>
	 
	<resultMap type="PatientVO" id="PatientVO">
	    <result column="AAA_UID" property="aaaUid"/>
	    <result column="AAA_COL1" property="aaaCol1"/>
	    <result column="AAA_COL2" property="aaaCol2"/>
	    <collection property="PatientVO" resultMap="PatientVO"/>
	</resultMap>
	
	<select id="detail" resultType="com.ksh.model.">
		SELECT
		s.s_date, s.s_startTime, s.s_endTime, s.s_memo, s.s_doctor, p.p_name, p.p_no, p.p_phone, p.p_visit, p.p_chart, s.s_no
		FROM patient AS p
		JOIN schedule AS s
		ON p.p_name = s.s_patient
		WHERE s.s_no = '4';
	</select>

</mapper>